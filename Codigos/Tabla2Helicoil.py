import pandas as pd

# Leer el archivo Excel
ruta_excel = "C:/Users/jc.garcia-taheno/Desktop/CE_3_TahenoHijes/Param_Union_TornHelic.xlsx"
hoja = "Helicoil_Catia"
df = pd.read_excel(ruta_excel, sheet_name=hoja)

# Eliminar columnas no deseadas (las que empiezan con "Unnamed")
df = df.loc[:, ~df.columns.str.contains('^Unnamed')]

# Lista de columnas que deben formatearse como decimales
decimal_columns = ['t2_min', 'W', 'd1_min', 'd1_max', 'D1Hc_min', 'D1Hc_max', 
                  'B', 't3_max', 'DHc_min','d1_medio','D1Hc_medio','W_mm']

# Verificar que las columnas se hayan leído correctamente
print("Columnas del DataFrame:")
print(df.columns)
print("\nPrimeras filas del DataFrame:")
print(df.head())

# Generar el texto con las reglas CATIA para Helicoils
lines = ["Rule Helicoil_Rule"]
for i, row in df.iterrows():
    prefix = "if" if i == 0 else "else if"
    
    # Nueva condición que incluye D1Hc_max como tercer parámetro
    lines.append(f'{prefix} Metrica_Seleccionada == {row["Metrica"]}mm And ' + 
                 f't2_Seleccionado == "{row["t2min  x d"]}" And ' +
                 f'D1Hc_max_Seleccionado == {float(row["D1Hc_max"]):.5f} {{')
    
    lines.append(f'   Metrica.1 = {float(row["Metrica"]):.5f}')
    lines.append(f'   t2_min = {float(row["t2_min"]):.5f}')
    
    for col in df.columns[2:]:  # Saltamos Metrica y t2min x d que ya están en la condición
        if col in decimal_columns:
            try:
                value = float(row[col])
                lines.append(f'   {col} = {value:.5f}')
            except (ValueError, TypeError):
                lines.append(f'   {col} = {row[col]}')  # Si no se puede convertir a float
        else:
            lines.append(f'   {col} = {row[col]}')
    
    lines.append("}")

# Unir todas las líneas
rules_text = "\n".join(lines)

# Guardar a archivo (ajusta la ruta según necesites)
output_path = "C:/Users/jc.garcia-taheno/Desktop/CE_3_TahenoHijes/Codigos/CATIA_Reglas_Helicoils.txt"
with open(output_path, "w") as f:
    f.write(rules_text)

print(f"Archivo generado exitosamente en: {output_path}")




























# # Datos de la tabla de Helicoils
# data = {
#     "Metrica.1": [2, 2, 2, 2, 2, 2.5, 2.5, 2.5, 2.5, 2.5, 3, 3, 3, 3, 3, 3.5, 3.5, 3.5, 3.5, 3.5,
#                 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
#                 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11],
#     "`t2min x d`": ["1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d", "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d",
#                   "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d", "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d",
#                   "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d", "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d",
#                   "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d", "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d",
#                   "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d", "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d",
#                   "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d", "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d",
#                   "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d", "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d",
#                   "1.0 d", "1.5 d", "2.0 d", "2.5 d", "3.0 d"],
#     "t2_min": [0.002, 0.003, 0.004, 0.005, 0.006, 0.0025, 0.00375, 0.005, 0.00625, 0.0075,
#                0.003, 0.0045, 0.006, 0.0075, 0.009, 0.0035, 0.00525, 0.007, 0.00875, 0.0105,
#                0.004, 0.006, 0.008, 0.01, 0.012, 0.005, 0.0075, 0.01, 0.0125, 0.015,
#                0.006, 0.009, 0.012, 0.015, 0.018, 0.007, 0.0105, 0.014, 0.0175, 0.021,
#                0.008, 0.012, 0.016, 0.02, 0.024, 0.008, 0.012, 0.016, 0.02, 0.024,
#                0.009, 0.0135, 0.018, 0.0225, 0.027, 0.01, 0.015, 0.02, 0.025, 0.03,
#                0.01, 0.015, 0.02, 0.025, 0.03, 0.01, 0.015, 0.02, 0.025, 0.03,
#                0.011, 0.0165, 0.022, 0.0275, 0.033],
#     "W": [0.0029, 0.0049, 0.0069, 0.0089, 0.0109, 0.0035, 0.0059, 0.0081, 0.0105, 0.0129,
#           0.0039, 0.0063, 0.0087, 0.0111, 0.0135, 0.0037, 0.0063, 0.0087, 0.0112, 0.0133,
#           0.0037, 0.0061, 0.0084, 0.0109, 0.0132, 0.0043, 0.0069, 0.0097, 0.0123, 0.0148,
#           0.0042, 0.0069, 0.0096, 0.0123, 0.0146, 0.0053, 0.0082, 0.0111, 0.0143, 0.0174,
#           0.0047, 0.0074, 0.0106, 0.0135, 0.0164, 0.0061, 0.0095, 0.0129, 0.0165, 0.0199,
#           0.0053, 0.0086, 0.0119, 0.0153, 0.0181, 0.005, 0.0081, 0.0112, 0.0142, 0.0172,
#           0.0076, 0.0121, 0.0163, 0.0207, 0.025, 0.006, 0.0097, 0.0131, 0.0169, 0.0201,
#           0.0056, 0.009, 0.0123, 0.0157, 0.0191],
#     "d1_min": [0.0026, 0.0026, 0.0026, 0.0026, 0.0026, 0.0033, 0.0033, 0.0033, 0.0033, 0.0033,
#                0.0038, 0.0038, 0.0038, 0.0038, 0.0038, 0.00442, 0.00442, 0.00442, 0.00442, 0.00442,
#                0.00505, 0.00505, 0.00505, 0.00505, 0.00505, 0.00635, 0.00635, 0.00635, 0.00635, 0.00635,
#                0.0076, 0.0076, 0.0076, 0.0076, 0.0076, 0.00865, 0.00865, 0.00865, 0.00865, 0.00865,
#                0.00985, 0.00985, 0.00985, 0.00985, 0.00985, 0.00985, 0.00985, 0.00985, 0.00985, 0.00985,
#                0.01085, 0.01085, 0.01085, 0.01085, 0.01085, 0.0121, 0.0121, 0.0121, 0.0121, 0.0121,
#                0.0121, 0.0121, 0.0121, 0.0121, 0.0121, 0.0121, 0.0121, 0.0121, 0.0121, 0.0121,
#                0.0131, 0.0131, 0.0131, 0.0131, 0.0131],
#     "d1_max": [0.0028, 0.0028, 0.0028, 0.0028, 0.0028, 0.0035, 0.0035, 0.0035, 0.0035, 0.0035,
#                0.004, 0.004, 0.004, 0.004, 0.004, 0.0046, 0.0046, 0.0046, 0.0046, 0.0046,
#                0.00525, 0.00525, 0.00525, 0.00525, 0.00525, 0.0066, 0.0066, 0.0066, 0.0066, 0.0066,
#                0.00785, 0.00785, 0.00785, 0.00785, 0.00785, 0.0089, 0.0089, 0.0089, 0.0089, 0.0089,
#                0.0101, 0.0101, 0.0101, 0.0101, 0.0101, 0.0101, 0.0101, 0.0101, 0.0101, 0.0101,
#                0.0111, 0.0111, 0.0111, 0.0111, 0.0111, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125,
#                0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125,
#                0.0135, 0.0135, 0.0135, 0.0135, 0.0135],
#     "D1Hc_min": [0.00209, 0.00209, 0.00209, 0.00209, 0.00209, 0.0026, 0.0026, 0.0026, 0.0026, 0.0026,
#                  0.00311, 0.00311, 0.00311, 0.00311, 0.00311, 0.00363, 0.00363, 0.00363, 0.00363, 0.00363,
#                  0.00415, 0.00415, 0.00415, 0.00415, 0.00415, 0.00517, 0.00517, 0.00517, 0.00517, 0.00517,
#                  0.00622, 0.00622, 0.00622, 0.00622, 0.00622, 0.00722, 0.00722, 0.00722, 0.00722, 0.00722,
#                  0.00827, 0.00827, 0.00827, 0.00827, 0.00827, 0.00822, 0.00822, 0.00822, 0.00822, 0.00822,
#                  0.00927, 0.00927, 0.00927, 0.00927, 0.00927, 0.01032, 0.01032, 0.01032, 0.01032, 0.01032,
#                  0.01022, 0.01022, 0.01022, 0.01022, 0.01022, 0.01027, 0.01027, 0.01027, 0.01027, 0.01027,
#                  0.01133, 0.01133, 0.01133, 0.01133, 0.01133],
#     "D1Hc_max": [2.18, 2.18, 2.18, 2.18, 2.18, 2.70, 2.70, 2.70, 2.70, 2.70,
#                  3.22, 3.22, 3.22, 3.22, 3.22, 3.76, 3.76, 3.76, 3.76, 3.76,
#                  4.29, 4.29, 4.29, 4.29, 4.29, 5.33, 5.33, 5.33, 5.33, 5.33,
#                  6.41, 6.41, 6.41, 6.41, 6.41, 7.41, 7.41, 7.41, 7.41, 7.41,
#                  8.48, 8.48, 8.48, 8.48, 8.48, 8.41, 8.41, 8.41, 8.41, 8.41,
#                  9.48, 9.48, 9.48, 9.48, 9.48, 10.56, 10.56, 10.56, 10.56, 10.56,
#                  10.41, 10.41, 10.41, 10.41, 10.41, 10.48, 10.48, 10.48, 10.48, 10.48,
#                  11.56, 11.56, 11.56, 11.56, 11.56],
#     #  "D1Hc_max":  [ 0.00218, 0.00218, 0.00218, 0.00218, 0.00218, 0.0027, 0.0027, 0.0027, 0.0027, 0.0027,
#     #             0.00322, 0.00322, 0.00322, 0.00322, 0.00322, 0.00376, 0.00376, 0.00376, 0.00376, 0.00376,
#     #             0.00429, 0.00429, 0.00429, 0.00429, 0.00429, 0.00533, 0.00533, 0.00533, 0.00533, 0.00533,
#     #             0.00641, 0.00641, 0.00641, 0.00641, 0.00641, 0.00741, 0.00741, 0.00741, 0.00741, 0.00741,
#     #             0.00848, 0.00848, 0.00848, 0.00848, 0.00848, 0.00841, 0.00841, 0.00841, 0.00841, 0.00841,
#     #             0.00948, 0.00948, 0.00948, 0.00948, 0.00948, 0.01056, 0.01056, 0.01056, 0.01056, 0.01056,
#     #             0.01041, 0.01041, 0.01041, 0.01041, 0.01041, 0.01048, 0.01048, 0.01048, 0.01048, 0.01048,
#     #             0.01156, 0.01156, 0.01156, 0.01156, 0.01156],

#     "B": [0.0021, 0.0021, 0.0021, 0.0021, 0.0021, 0.0026, 0.0026, 0.0026, 0.0026, 0.0026,
#           0.0032, 0.0032, 0.0032, 0.0032, 0.0032, 0.0037, 0.0037, 0.0037, 0.0037, 0.0037,
#           0.0042, 0.0042, 0.0042, 0.0042, 0.0042, 0.0052, 0.0052, 0.0052, 0.0052, 0.0052,
#           0.0063, 0.0063, 0.0063, 0.0063, 0.0063, 0.0073, 0.0073, 0.0073, 0.0073, 0.0073,
#           0.0084, 0.0084, 0.0084, 0.0084, 0.0084, 0.0083, 0.0083, 0.0083, 0.0083, 0.0083,
#           0.0094, 0.0094, 0.0094, 0.0094, 0.0094, 0.0105, 0.0105, 0.0105, 0.0105, 0.0105,
#           0.01025, 0.01025, 0.01025, 0.01025, 0.01025, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104,
#           0.0115, 0.0115, 0.0115, 0.0115, 0.0115],
#     "t3_max": [0.0018, 0.0028, 0.0038, 0.0048, 0.0058, 0.0023, 0.0035, 0.0048, 0.006, 0.0073,
#                0.0027, 0.0042, 0.0057, 0.0072, 0.0087, 0.0032, 0.005, 0.0067, 0.0085, 0.0102,
#                0.0036, 0.0056, 0.0076, 0.0096, 0.0116, 0.0046, 0.0071, 0.0096, 0.0121, 0.0146,
#                0.0055, 0.0085, 0.0115, 0.0145, 0.0175, 0.0065, 0.01, 0.0135, 0.017, 0.0205,
#                0.0074, 0.0114, 0.0154, 0.0194, 0.0234, 0.0075, 0.0115, 0.0155, 0.0195, 0.0235,
#                0.0084, 0.0129, 0.0179, 0.0219, 0.0264, 0.0092, 0.0142, 0.0192, 0.0242, 0.0292,
#                0.0095, 0.0145, 0.0195, 0.0245, 0.0295, 0.0094, 0.0144, 0.0194, 0.0244, 0.0294,
#                0.0102, 0.0157, 0.0212, 0.0267, 0.0322],
#     "DHc_min": [0.00252, 0.00252, 0.00252, 0.00252, 0.00252, 0.00308, 0.00308, 0.00308, 0.00308, 0.00308,
#                 0.00365, 0.00365, 0.00365, 0.00365, 0.00365, 0.00428, 0.00428, 0.00428, 0.00428, 0.00428,
#                 0.00491, 0.00491, 0.00491, 0.00491, 0.00491, 0.00604, 0.00604, 0.00604, 0.00604, 0.00604,
#                 0.0073, 0.0073, 0.0073, 0.0073, 0.0073, 0.0083, 0.0083, 0.0083, 0.0083, 0.0083,
#                 0.00962, 0.00962, 0.00962, 0.00962, 0.00962, 0.0093, 0.0093, 0.0093, 0.0093, 0.0093,
#                 0.01062, 0.01062, 0.01062, 0.01062, 0.01062, 0.01195, 0.01195, 0.01195, 0.01195, 0.01195,
#                 0.0113, 0.0113, 0.0113, 0.0113, 0.0113, 0.01162, 0.01162, 0.01162, 0.01162, 0.01162,
#                 0.01295, 0.01295, 0.01295, 0.01295, 0.01295]
# }
