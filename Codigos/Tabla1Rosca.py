import pandas as pd

# Datos copiados de la tabla proporcionada
data = {
    "Metrica": [1, 1.1, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.5, 3, 3.5, 4, 4.5, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 20],
    "Paso": [0.25, 0.25, 0.25, 0.3, 0.35, 0.35, 0.4, 0.45, 0.45, 0.5, 0.6, 0.7, 0.75, 0.8, 1, 1, 1.25, 1.25, 1.5, 1.5, 1.75, 2, 2, 2.5, 2.5],
    "dmax": [1.000, 1.100, 1.200, 1.400, 1.581, 1.781, 1.981, 2.180, 2.480, 2.980, 3.479, 3.978, 4.478, 4.976, 5.974, 6.974, 7.972, 8.972, 9.968, 10.968, 11.966, 13.962, 15.962, 17.958, 19.958],
    "dmin": [0.933, 1.033, 1.133, 1.325, 1.496, 1.696, 1.886, 2.080, 2.380, 2.874, 3.354, 3.838, 4.338, 4.826, 5.794, 6.794, 7.760, 8.760, 9.732, 10.732, 11.701, 13.682, 15.682, 17.623, 19.623],
    "d2max": [0.838, 0.938, 1.038, 1.205, 1.354, 1.554, 1.721, 1.888, 2.188, 2.655, 3.089, 3.523, 3.991, 4.456, 5.324, 6.324, 7.160, 8.160, 8.994, 9.994, 10.829, 12.663, 14.663, 16.334, 18.334],
    "d2min": [0.785, 0.885, 0.985, 1.149, 1.291, 1.491, 1.654, 1.817, 2.117, 2.580, 3.004, 3.433, 3.901, 4.361, 5.212, 6.212, 7.042, 8.042, 8.862, 9.862, 10.679, 12.503, 14.503, 16.164, 18.164],
    "d3max": [0.693, 0.793, 0.893, 1.032, 1.152, 1.352, 1.490, 1.628, 1.928, 2.367, 2.743, 3.119, 3.558, 3.995, 4.747, 5.747, 6.438, 7.438, 8.128, 9.128, 9.819, 11.508, 13.508, 14.891, 16.891],
    "d3min": [0.630, 0.730, 0.830, 0.964, 1.075, 1.275, 1.407, 1.540, 1.840, 2.273, 2.635, 3.002, 3.439, 3.869, 4.596, 5.596, 6.272, 7.272, 7.938, 8.938, 9.602, 11.271, 13.271, 14.625, 16.625],
    "D2min": [0.838, 0.938, 1.038, 1.205, 1.373, 1.573, 1.740, 1.908, 2.208, 2.675, 3.110, 3.545, 4.013, 4.480, 5.350, 6.350, 7.188, 8.188, 9.026, 10.026, 10.863, 12.701, 14.701, 16.376, 18.376],
    "D2max": [0.894, 0.994, 1.094, 1.265, 1.458, 1.658, 1.830, 2.003, 2.303, 2.775, 3.222, 3.663, 4.131, 4.605, 5.500, 6.500, 7.348, 8.348, 9.206, 10.206, 11.063, 12.913, 14.913, 16.600, 18.600],
    "D1min": [0.729, 0.829, 0.929, 1.075, 1.221, 1.421, 1.567, 1.713, 2.013, 2.459, 2.850, 3.242, 3.688, 4.134, 4.917, 5.917, 6.647, 7.647, 8.376, 9.376, 10.106, 11.835, 13.835, 15.294, 17.294],
    "D1max": [0.785, 0.885, 0.985, 1.142, 1.321, 1.521, 1.679, 1.838, 2.138, 2.599, 3.010, 3.422, 3.878, 4.334, 5.153, 6.153, 6.912, 7.912, 8.676, 9.676, 10.441, 12.210, 14.210, 15.744, 17.744]
}

df = pd.DataFrame(data)

# Generar el texto con las reglas CATIA
lines = ["Rule Tornillo_Metrico_Rule"]
for i, row in df.iterrows():
    prefix = "if" if i == 0 else "else if"
    lines.append(f"{prefix} Metrica_Seleccionada == {row['Metrica']}mm {{")
    lines.append(f"   Metrica = {row['Metrica']:.3f}mm")  # Línea adicional solicitada
    for col in df.columns[1:]:
        lines.append(f"   {col} = {row[col]:.3f}mm")
    lines.append("}")

# Unir todas las líneas
rules_text = "\n".join(lines)

# Guardar a archivo
output_path = "C:/Users/jc.garcia-taheno/Desktop/CE_3_TahenoHijes/Codigos/CATIA_Reglas_Metricas.txt"
with open(output_path, "w") as f:
    f.write(rules_text)

output_path
